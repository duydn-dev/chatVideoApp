<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat video</title>
    <link rel="stylesheet" href="/assets/css/uikit.min.css">
    <link rel="stylesheet" href="/fontawesome-free/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/css/style.css">
    <style>
        video {
            -webkit-transform: scaleX(-1);
            transform: scaleX(-1);
        }
        .uk-offcanvas-bar{

        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="/assets/js/jquery-3.6.0.min.js"></script>
    <script src="/assets/js/uikit.min.js"></script>
    <script src="/assets/js/uikit-icons.min.js"></script>
    <script src="/socket.io/socket.io.js" defer></script>
    <script>
        const r_id = "<%= roomId %>";
    </script>
    <script src="/assets/js/index.js" defer></script>
</head>

<body>
    <div class="uk-container" id="app">
        <div class="col-lg-12 uk-margin-small-top">
            <div class="row">
                <div v-for="item in client" :key="item.userId" class="col-lg-4" :id="'d_' + item.userId">
                    <div class="uk-card uk-card-default uk-padding-small video-main">
                        <div class="uk-inline uk-inline-clip uk-transition-toggle w-100 h-100">
                            <div :id="'u_' + item.userId" :class="item.isTurnOnCamera ? '': 'd-none'"></div>
                            <div :class="!item.isTurnOnCamera ? '': 'd-none'">
                                <div class="w-100 h-100 text-center d-flex">
                                    <img src="/assets/imgs/no-user.png" alt="" width="50" height="50" style="align-items: center;">
                                </div>
                            </div>
                            <div class="uk-transition-slide-bottom uk-position-bottom uk-overlay uk-overlay-primary">
                                <div class="text-center">
                                    <p class="text-white">{{item.userName}}</p>
                                    <button v-if="item.userId == currentUser.userId" class="uk-button uk-button-default uk-margin-small-right" type="button" uk-toggle="target: #left-menu">Thao tác</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- side bar bên trái -->
        <div class="left-side">
            <div id="left-menu" uk-offcanvas>
                <div class="uk-offcanvas-bar">
                    <button class="uk-offcanvas-close" type="button" uk-close></button>
                    <h3>Thao tác</h3>

                    <div class="uk-flex">
                        <div class="w-50">
                            <button @click="onToggleCamera()" class="uk-button uk-button-default w-100" uk-tooltip="title: Tắt/Bật Video; pos: bottom">
                                <i :class="'fas fa-video' + (currentUser.isTurnOnCamera ? '': '-slash')"></i>
                            </button>
                        </div>
                        <div class="w-50">
                            <button @click="onToggleMicrophone()" class="uk-button uk-button-default w-100" uk-tooltip="title: Tắt/Bật Mic; pos: bottom">
                                <i :class="'fas fa-microphone' + (currentUser.isTurnOnAudio ? '': '-slash')"></i>
                            </button>
                        </div>
                    </div>
                    <hr>
                    <div class="message-section" id="message-section">
                        <ul class="message-list">
                            <li v-for="item in messages" :key="item.userId" style="list-style-type: none;">
                                <div class="w-100 d-block clearfix pb-1 pt-2">
                                    <span :class="'uk-card uk-card' + (item.userId != currentUser.userId ? '-secondary': '-default me') + ' uk-light message-item'">
                                        <label :class="'message-text' + (item.userId != currentUser.userId ? '': ' text-dark')"> <b><u>{{item.userName}}:</u></b>&#160;{{item.message}}</label>
                                    </span>
                                </div>
                            </li>
                        </ul>
                        
                        <!-- <div class="uk-card uk-card-default uk-light message-item me">
                            <p class="message-text text-dark">Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
                        </div> -->

                        <div class="message-input w-100">
                            <div class="uk-inline w-100">
                                <span class="uk-form-icon uk-form-icon-flip" uk-icon="icon: forward"></span>
                                <input class="uk-input" type="text" @keyup.enter="onSendMessage" placeholder="Nhập tin nhắn..." v-model="inMess">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>